<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Set of functions for automatic data validation report. â€¢ DATA.VALIDATOR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Set of functions for automatic data validation report.">
<meta property="og:description" content="Validate dataset by columns and rows using convenient predicates inspired by assertr package. 
             Generate good looking HTML report or print console output to display in logs of your data processing pipeline.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">DATA.VALIDATOR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Start
  </a>
</li>
<li>
  <a href="articles/index.html">
    <span class="fa fa-university"></span>
     
    Tutorials
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="https://github.com/Appsilon/data.validator">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/Appsilon">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<p><img src="assets/hexsticker.png" width="200px" align="right"></p>
<div id="datavalidator" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#datavalidator" class="anchor"></a>data.validator</h1></div>
<div id="description" class="section level2">
<h2 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h2>
<p><code>data.validator</code> is a package for scalable and reproducible data validation. It provides:</p>
<ul>
<li>Functions for validating datasets in <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code> pipelines: <code>assert_if</code>, <code>assert_cols</code> and <code>assert_rows</code>
</li>
<li>Predicate functions from <a href="https://github.com/ropensci/assertr">assertr</a> package, like <code>in_set</code>, <code>within_bounds</code>, etc.</li>
<li>Functions for creating user-friendly reports that you can send to email, store in logs folder, or generate automatically with RStudio Connect.</li>
</ul>
<p><img src="assets/semantic_report_example.gif"></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Latest development version:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"Appsilon/data.validator"</span>)</pre></div>
</div>
<div id="data-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-validation" class="anchor"></a>Data validation</h2>
<p>Validaton cycle is simple:</p>
<ol>
<li>Create report object.</li>
<li>Prepare your dataset. You can load it, preprocess and then run <code>validate()</code> pipeline.</li>
<li>Validate your datasets.
<ul>
<li>Start validation block with <code>validate()</code> function. It adds new section to the report.</li>
<li>Use <code>assert_*</code> functions and predicates to validate the data. You can create your custom predicates. See <code>between()</code> example.</li>
<li>Add assertion results to the report with <code><a href="reference/add_results.html">add_results()</a></code>
</li>
</ul>
</li>
<li>Print the results or generate HTML report.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">assertr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">data.validator</span>)

<span class="no">report</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/data_validation_report.html">data_validation_report</a></span>()

<span class="fu">validate</span>(<span class="no">mtcars</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Verifying cars dataset"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">assert_if</span>(<span class="no">drat</span> <span class="kw">&lt;</span> <span class="fl">0</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Column drat has only positive values"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">assert_cols</span>(<span class="fu"><a href="https://docs.ropensci.org/assertr/reference/in_set.html">in_set</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">2</span>)), <span class="no">vs</span>, <span class="no">am</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="st">"vs and am values equal 0 or 2 only"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">assert_cols</span>(<span class="fu"><a href="https://docs.ropensci.org/assertr/reference/within_n_sds.html">within_n_sds</a></span>(<span class="fl">1</span>), <span class="no">mpg</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="st">"mpg within 1 sds"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://docs.ropensci.org/assertr/reference/assert_rows.html">assert_rows</a></span>(<span class="no">num_row_NAs</span>, <span class="fu"><a href="https://docs.ropensci.org/assertr/reference/within_bounds.html">within_bounds</a></span>(<span class="fl">0</span>, <span class="fl">2</span>), <span class="no">vs</span>, <span class="no">am</span>, <span class="no">mpg</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="st">"not too many NAs in rows"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://docs.ropensci.org/assertr/reference/assert_rows.html">assert_rows</a></span>(<span class="no">maha_dist</span>, <span class="fu"><a href="https://docs.ropensci.org/assertr/reference/within_n_mads.html">within_n_mads</a></span>(<span class="fl">10</span>), <span class="fu">everything</span>(), <span class="kw">description</span> <span class="kw">=</span> <span class="st">"maha dist within 10 mads"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/add_results.html">add_results</a></span>(<span class="no">report</span>)

<span class="no">between</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">a</span>, <span class="no">b</span>) {
  <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">a</span> <span class="kw">&lt;=</span> <span class="no">x</span> <span class="kw">&amp;&amp;</span> <span class="no">x</span> <span class="kw">&lt;=</span> <span class="no">b</span> }
}

<span class="fu">validate</span>(<span class="no">iris</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Verifying flower dataset"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">assert_if</span>(<span class="no">Sepal.Length</span> <span class="kw">&gt;</span> <span class="fl">0</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Sepal length is greater than 0"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">assert_cols</span>(<span class="fu">between</span>(<span class="fl">0</span>, <span class="fl">4</span>), <span class="no">Sepal.Width</span>, <span class="kw">description</span> <span class="kw">=</span> <span class="st">"Sepal width is between 0 and 4"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/add_results.html">add_results</a></span>(<span class="no">report</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">report</span>)</pre></div>
</div>
<div id="reporting" class="section level2">
<h2 class="hasAnchor">
<a href="#reporting" class="anchor"></a>Reporting</h2>
<p>Print results to the console:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">report</span>)

<span class="co"># Validation summary: </span>
<span class="co">#  Number of successful validations: 1</span>
<span class="co">#  Number of failed validations: 4</span>
<span class="co">#  Number of validations with warnings: 1</span>
<span class="co">#</span>
<span class="co"># Advanced view: </span>
<span class="co">#  </span>
<span class="co"># |table_name |description                                       |type    | total_violations|</span>
<span class="co"># |:----------|:-------------------------------------------------|:-------|----------------:|</span>
<span class="co"># |mtcars     |Column drat has only positive values              |success |               NA|</span>
<span class="co"># |mtcars     |Column drat has only values larger than 3         |error   |                4|</span>
<span class="co"># |mtcars     |Each row sum for am:vs columns is less or equal 1 |error   |                7|</span>
<span class="co"># |mtcars     |For wt and qsec we have: abs(col) &lt; 2 * sd(col)   |error   |                4|</span>
<span class="co"># |mtcars     |vs and am values equal 0 or 2 only                |error   |               27|</span>
<span class="co"># |mtcars     |vs and am values should equal 3 or 4              |warning |               24|</span></pre></div>
<p>Save as HTML report</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="reference/save_report.html">save_report</a></span>(<span class="no">report</span>)</pre></div>
</div>
<div id="full-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#full-examples" class="anchor"></a>Full examples</h2>
<ul>
<li><a href="https://github.com/Appsilon/data.validator/blob/master/examples/custom_report/example.R">Custom reporting on leaflet map</a></li>
</ul>
<p><img src="assets/custom_report_example.gif"></p>
<ul>
<li><p><a href="https://github.com/Appsilon/data.validator/blob/master/examples/minimal_example/example.R">Minimal example to get you started</a></p></li>
<li><p><a href="https://github.com/Appsilon/data.validator/blob/master/examples/new_api/example.R">Convenient API</a></p></li>
<li><p><a href="https://github.com/Appsilon/data.validator/blob/master/examples/sample_validations/example.R">Various way of saving reports</a></p></li>
</ul>
</div>
<div id="using-custom-report-templates" class="section level2">
<h2 class="hasAnchor">
<a href="#using-custom-report-templates" class="anchor"></a>Using custom report templates</h2>
<p>In order to generate rmarkdown report <code>data.validator</code> uses predefined report template. You may find it in <code>inst/rmarkdown/templates/standard/skeleton/skeleton.Rmd</code>.</p>
<p>The report contains basic requirements for each report template used by <code>save_report</code> function:</p>
<ul>
<li>defining params</li>
</ul>
<pre><code>params:
  generate_report_html: !expr function(...) {}
  extra_params: list()</code></pre>
<ul>
<li>calling content renderer chunk</li>
</ul>
<pre><code>```{r generate_report, echo = FALSE}
params$generate_report_html(params$extra_params)
```</code></pre>
<p>If you want to use the template as a base you can use RStudio. Load the package and use <code>File -&gt; New File -&gt; R Markdown -&gt; From template -&gt; Simple structure for HTML report summary</code>. Then modify the template adding custom title, or graphics with leaving the below points unchanged and specify the path inside <code>save_report</code>â€™s <code>template</code> parameter.</p>
</div>
</div>
<div id="how-the-package-can-be-used-in-production" class="section level1">
<h1 class="hasAnchor">
<a href="#how-the-package-can-be-used-in-production" class="anchor"></a>How the package can be used in production?</h1>
<p>The package was successfuly used by Appsilon in production enviroment for protecting Shiny Apps against beeing run on incorrect data.</p>
<p>The workflow was based on the below steps:</p>
<ol>
<li><p>Running <a href="https://rstudio.com/products/connect/">RStudio Connect Scheduler</a> daily.</p></li>
<li><p>Scheduler sources the data from PostgreSQL table and validates it based on predefined rules.</p></li>
<li><p>Based on validation results a new <code>data.validator</code> report is created.</p></li>
</ol>
<p>4a. When data is violated:</p>
<ul>
<li><p>data provider and person responsible for data quality receives report via email</p></li>
<li><p>thanks to <code>assertr</code> functionality, the report is easily understandable both for technical, and non-technical person</p></li>
<li><p>data provider makes required data fixes</p></li>
</ul>
<p>4b. When data is correct:</p>
<ul>
<li>a specific trigger is sent in order to reload Shiny data</li>
</ul>
<p>The workflow is presented on below graphics <img src="assets/workflow.png"></p>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>We welcome contributions of all types!</p>
<p>We encourage typo corrections, bug reports, bug fixes and feature requests. Feedback on the clarity of the documentation and examples is especially valuable.</p>
<p>If you want to contribute to this project please submit a regular PR, once youâ€™re done with new feature or bug fix.</p>
<div id="changes-in-documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#changes-in-documentation" class="anchor"></a>Changes in documentation</h3>
<p>Both repository <strong>README.md</strong> file and an official documentation page are generated with markdown.</p>
<p>Documentation is rendered with <code>pkgdown</code>. Just run <code><a href="https://pkgdown.r-lib.org/reference/build_site.html">pkgdown::build_site()</a></code> after rendering new <strong>README.md</strong>.</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/Appsilon/data.validator/">https://â€‹github.com/â€‹Appsilon/â€‹data.validator/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/Appsilon/data.validator/issues">https://â€‹github.com/â€‹Appsilon/â€‹data.validator/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Krystian Igras <br><small class="roles"> Author, maintainer </small>  </li>
<li>Marcin Dubel <br><small class="roles"> Author </small>  </li>
<li>PaweÅ‚ PrzytuÅ‚a <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://codecov.io/gh/Appsilon/data.validator?branch=master"><img src="https://codecov.io/gh/Appsilon/data.validator/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Krystian Igras, Marcin Dubel, PaweÅ‚ PrzytuÅ‚a.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
